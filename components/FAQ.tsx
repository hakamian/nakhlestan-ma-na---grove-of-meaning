
import React, { useState, useMemo } from 'react';
import { User } from '../types.ts';
import { PlusIcon, MinusIcon, ChatBubbleLeftRightIcon } from './icons.tsx';

const generalFaqs = [
    {
        question: "نخلستان معنا چیست؟",
        answer: "نخلستان معنا یک کسب و کار اجتماعی است که با کاشت نخل به دنبال ایجاد معنا برای افراد، اشتغال‌زایی برای جوامع محلی، و حفاظت از محیط زیست است. هر نخل کاشته شده، نماد یک داستان و میراث انسانی است."
    },
    {
        question: "آیا کاشت نخل‌ها واقعی است؟",
        answer: "بله، کاملاً. تمام نخل‌ها در مناطق مشخص شده در پروژه‌های اجتماعی ما (مانند خوزستان و کرمان) توسط تیم‌های محلی کاشته می‌شوند. شما می‌توانید گزارش پیشرفت پروژه‌ها را در صفحه مربوطه مشاهده کنید."
    },
    {
        question: "چگونه می‌توانم در این پروژه مشارکت کنم؟",
        answer: "شما می‌توانید با خرید 'میراث نخل' برای ثبت لحظات مهم زندگی، شرکت در دوره‌های آموزشی، یا حمایت مستقیم از پروژه‌های اجتماعی در این حرکت سهیم باشید. هر فعالیت شما به رشد این جنبش کمک می‌کند."
    },
    {
        question: "چگونه از پول من استفاده می‌شود؟",
        answer: "تمام سود حاصل از فروش نخل‌های نمادین و دوره‌های آموزشی، مستقیماً برای توسعه پروژه‌های اجتماعی، ایجاد شغل برای جوانان مناطق محروم، و کاشت نخل‌های بیشتر برای احیای محیط زیست سرمایه‌گذاری می‌شود."
    },
    {
        question: "آیا می‌توانم یک نخل را به کسی هدیه دهم؟",
        answer: "بله! شما می‌توانید هنگام کاشت نخل، نام فرد مورد نظر خود را به عنوان گیرنده ثبت کرده و یک پیام تقدیمی شخصی برای او بنویسید. شناسنامه دیجیتال نخل به نام آن فرد صادر خواهد شد."
    },
    {
        question: "امتیازها و سطوح کاربری چه کاربردی دارند؟",
        answer: "امتیازها بخشی از 'سفر قهرمانی' شما در نخلستان معناست. با فعالیت در سایت، امتیاز کسب می‌کنید و به سطوح بالاتری می‌رسید. این سطوح مزایای ویژه‌ای مانند دسترسی به محتوای خاص، تخفیف در دوره‌ها، و شانس دریافت بورسیه را برای شما باز می‌کنند."
    },
    {
        question: "آزمایشگاه معنا و ابزارهای هوش مصنوعی چیست؟",
        answer: "آزمایشگاه معنا یک فضای خلاقیت است که در آن می‌توانید با استفاده از ابزارهای پیشرفته هوش مصنوعی (مانند تولید تصویر و ویدیو) ایده‌های خود را به آثار هنری تبدیل کرده و آنها را در گاهشمار خود ثبت کنید."
    },
    {
        question: "«نگهبان معنا» کیست؟",
        answer: "«نگهبانان» باتجربه‌ترین و متعهدترین اعضای جامعه ما هستند که به سطح مشخصی از امتیاز و مشارکت رسیده‌اند. آن‌ها به عنوان مربی و راهنما به اعضای جدیدتر کمک می‌کنند تا مسیر معنای خود را بهتر پیدا کنند."
    },
    {
        question: "چگونه می‌توانم تاثیر پروژه را دنبال کنم؟",
        answer: "شما می‌توانید از طریق «نقشه تاثیر» در منوی سایت، آمار دقیق و به‌روز تعداد نخل‌های کاشته شده، شغل‌های ایجاد شده و میزان سرمایه‌گذاری اجتماعی در هر استان را به صورت شفاف مشاهده کنید."
    },
    {
        question: "آیا امکان بازدید از نخلستان‌ها وجود دارد؟",
        answer: "بله، ما در حال برنامه‌ریزی برای برگزاری تورهای بازدید از پروژه‌ها و اقامت در اقامتگاه بوم‌گردی نخلستان معنا برای اعضای ویژه هستیم. اطلاعات بیشتر در آینده اعلام خواهد شد."
    }
];

const newUserFaqs = [
    {
        question: "چطور می‌توانم اولین نخلم را بکارم؟",
        answer: "به صفحه «میراث نخل» بروید، نیتی که با لحظه شما همسو است (مانند تصمیم، موفقیت یا سپاس) را انتخاب کنید و مراحل آیین کاشت را دنبال نمایید."
    },
    {
        question: "امتیاز چیست و چگونه آن را کسب کنم؟",
        answer: "امتیازها پاداش شما برای مشارکت در جنبش است. با فعالیت‌هایی مانند کاشت نخل، تکمیل پروفایل، شرکت در دوره‌ها و ثبت تامل، امتیاز کسب می‌کنید و در «سفر قهرمانی» خود پیشرفت می‌کنید."
    },
    {
        question: "داشبورد من کجاست و چه کاربردی دارد؟",
        answer: "داشبورد، مرکز فرماندهی شماست. از منوی بالا به آن دسترسی دارید و می‌توانید آمار پیشرفت، آخرین فعالیت‌ها و قدم بعدی پیشنهادی برای رشد خود را در آن ببینید."
    },
    {
        question: "چگونه می‌توانم پروفایلم را تکمیل کنم؟",
        answer: "از منوی کاربری خود به صفحه «پروفایل» بروید. با تکمیل اطلاعات خود نه تنها امتیاز هدیه می‌گیرید، بلکه به ما کمک می‌کنید تا تجربه بهتری برای شما بسازیم."
    },
    {
        question: "«باغ عمومی» چیست؟",
        answer: "باغ عمومی فضایی است که در آن آخرین فعالیت‌های اعضای جامعه (مانند کاشت نخل) نمایش داده می‌شود. شما می‌توانید با دیگران همدلی کرده و در داستان‌هایشان سهیم شوید."
    }
];

const guardianFaqs = [
    {
        question: "نقش من به عنوان یک «نگهبان» چیست؟",
        answer: "شما به عنوان یک نگهبان، ستون و راهنمای جامعه هستید. نقش شما الهام‌بخشی به اعضای جدیدتر، پاسخ به سوالات آنها و کمک به حفظ ارزش‌های اصلی جنبش نخلستان معناست."
    },
    {
        question: "چگونه می‌توانم یک «رهجو» را راهنمایی کنم؟",
        answer: "از طریق «سرای نگهبانان»، می‌توانید به درخواست‌های مربی‌گری پاسخ دهید. پس از پذیرش یک رهجو، می‌توانید با ارسال «تامل ماهانه» (Check-in) و پیام خصوصی، او را در مسیرش همراهی کنید."
    },
    {
        question: "«تامل ماهانه» (Check-in) چیست؟",
        answer: "این یک ابزار قدرتمند برای راهنمایی است. شما یک سوال عمیق و تامل‌برانگیز برای رهجوی خود ارسال می‌کنید تا به او در پیدا کردن شفافیت و معنا در مسیرش کمک کنید."
    },
    {
        question: "آیا می‌توانم برای رهجویانم امتیاز ویژه‌ای ثبت کنم؟",
        answer: "در حال حاضر این قابلیت در دست توسعه است. در آینده، نگهبانان قادر خواهند بود برای فعالیت‌های برجسته رهجویان خود، امتیاز ویژه‌ای به عنوان پاداش در نظر بگیرند."
    },
    {
        question: "چگونه در تصمیم‌گیری‌های آینده جنبش مشارکت کنم؟",
        answer: "حلقه نگهبانان به عنوان یک شورای مشورتی برای تیم اصلی نخلستان معنا عمل می‌کند. نظرات و پیشنهادات شما از طریق کانال‌های ارتباطی ویژه شنیده خواهد شد."
    }
];


const FAQItem: React.FC<{ item: { question: string; answer: string }; isOpen: boolean; onClick: () => void }> = ({ item, isOpen, onClick }) => {
    return (
        <div className="bg-white dark:bg-stone-800/50 rounded-xl shadow-sm transition-all duration-300">
            <button
                onClick={onClick}
                className="w-full flex justify-between items-center text-right p-5"
                aria-expanded={isOpen}
            >
                <span className="font-bold text-stone-800 dark:text-stone-100">{item.question}</span>
                <div className="flex-shrink-0 w-6 h-6 rounded-full bg-amber-100 dark:bg-amber-900/50 flex items-center justify-center">
                    {isOpen ? <MinusIcon className="w-4 h-4 text-amber-600 dark:text-amber-400" /> : <PlusIcon className="w-4 h-4 text-amber-600 dark:text-amber-400" />}
                </div>
            </button>
            <div
                className="overflow-hidden transition-all duration-500 ease-in-out"
                style={{ maxHeight: isOpen ? '200px' : '0px' }}
            >
                <div className="px-5 pb-5 text-stone-600 dark:text-stone-300 leading-relaxed">
                    <p>{item.answer}</p>
                </div>
            </div>
        </div>
    );
};

interface FAQProps {
  user: User | null;
}

const FAQ: React.FC<FAQProps> = ({ user }) => {
    const [openIndex, setOpenIndex] = useState<number | null>(0);

    const faqData = useMemo(() => {
        if (!user) {
            return generalFaqs;
        }
        if (user.isGuardian) {
            return guardianFaqs;
        }
        // A simple way to define a "new user"
        if (user.timeline && user.timeline.length < 3) {
            return newUserFaqs;
        }
        return generalFaqs;
    }, [user]);

    const handleToggle = (index: number) => {
        setOpenIndex(openIndex === index ? null : index);
    };

    return (
        <div className="max-w-3xl mx-auto">
            <div className="text-center mb-10">
                <ChatBubbleLeftRightIcon className="w-12 h-12 text-amber-500 mx-auto mb-3" />
                <h2 className="text-3xl font-bold text-stone-800 dark:text-stone-100">پاسخ به پرسش‌های شما</h2>
                <p className="mt-2 text-stone-600 dark:text-stone-300">هرآنچه برای شروع سفر خود باید بدانید.</p>
            </div>
            <div className="space-y-4">
                {faqData.map((item, index) => (
                    <FAQItem
                        key={index}
                        item={item}
                        isOpen={openIndex === index}
                        onClick={() => handleToggle(index)}
                    />
                ))}
            </div>
        </div>
    );
};

export default FAQ;